(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{354:function(e,t){},392:function(e,t,r){},416:function(e,t,r){"use strict";var o=r(392);r.n(o).a},436:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-block"},[r("h2",{staticClass:"form-block__title"},[e._v(e._s(e.formTitle))]),r("form",{staticClass:"form review-form form-block__content form-block__content__review"},[r("div",{staticClass:"form__pic form__pic__review"},[r("label",{staticClass:"form__upload-pic form__upload-pic__review"},[r("div",{staticClass:"form__upload-pic-container__review",class:{filled:this.PhotoURL.length,error:e.validation.firstError("PhotoURL")},style:{backgroundImage:"url("+this.PhotoURL+")"}},[r("input",{staticClass:"form__upload-pic-input",attrs:{type:"file"},on:{change:e.addAndRender}}),r("div",{staticClass:"form__upload-pic-error"},[r("error-tooltip",{attrs:{errorText:e.validation.firstError("PhotoURL")}})],1)]),r("div",{staticClass:"button button__upload-review-pic"},[e._v("Добавить фото")])])]),r("div",{staticClass:"form__info form__info__review"},[r("div",{staticClass:"form__row form__row__review-author-info"},[r("div",{staticClass:"form__column form__column__review"},[r("label",{staticClass:"form__info-block",class:{error:e.validation.firstError("review.author")},attrs:{for:"name"}},[r("span",{staticClass:"form__label"},[e._v("Имя автора")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.review.author,expression:"review.author"}],staticClass:"form__input form__input__name",attrs:{id:"name",type:"text",name:"name",placeholder:"Введите имя автора"},domProps:{value:e.review.author},on:{input:function(t){t.target.composing||e.$set(e.review,"author",t.target.value)}}}),r("div",{staticClass:"form__info-block-error"},[r("error-tooltip",{attrs:{errorText:e.validation.firstError("review.author")}})],1)])]),r("div",{staticClass:"form__column form__column__review"},[r("label",{staticClass:"form__info-block",class:{error:e.validation.firstError("review.occ")},attrs:{for:"position"}},[r("span",{staticClass:"form__label"},[e._v("Титул автора")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.review.occ,expression:"review.occ"}],staticClass:"form__input form__input__position",attrs:{id:"position",type:"text",name:"position",placeholder:"Введите титул автора"},domProps:{value:e.review.occ},on:{input:function(t){t.target.composing||e.$set(e.review,"occ",t.target.value)}}}),r("div",{staticClass:"form__info-block-error"},[r("error-tooltip",{attrs:{errorText:e.validation.firstError("review.occ")}})],1)])])]),r("div",{staticClass:"form__row form__row__textarea"},[r("div",{staticClass:"form__column"},[r("label",{staticClass:"form__info-block form__info-block__textarea",class:{error:e.validation.firstError("review.text")},attrs:{for:"position"}},[r("span",{staticClass:"form__label"},[e._v("Отзыв")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.review.text,expression:"review.text"}],staticClass:"form__textarea",attrs:{id:"review",name:"review",rows:"7",placeholder:"Введите отзыв"},domProps:{value:e.review.text},on:{input:function(t){t.target.composing||e.$set(e.review,"text",t.target.value)}}}),r("div",{staticClass:"form__info-block-error"},[r("error-tooltip",{attrs:{errorText:e.validation.firstError("review.text")}})],1)])])]),r("div",{staticClass:"form__row form__row__buttons"},[r("div",{staticClass:"form__column"},[r("div",{staticClass:"form__buttons form__buttons__review"},[r("button",{staticClass:"button button__cancel-edit",attrs:{type:"button"},on:{click:e.CLOSE_FORM}},[e._v("Отмена")]),e.reviewAdd.editMode?e._e():r("button",{staticClass:"button button__save-edit",attrs:{type:"button"},on:{click:e.addNewReview}},[e._v("Сохранить")]),e.reviewAdd.editMode?r("button",{staticClass:"button button__save-edit",attrs:{type:"button"},on:{click:e.saveReadyReview}},[e._v("Сохранить")]):e._e()])])])])])])};o._withStripped=!0;var i=r(139),a=r(65);function n(e,t,r,o,i,a,n){try{var s=e[a](n),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,i)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(r,!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v,d,_="https://webdev-api.loftschool.com",f={mixins:[r(65).mixin],validators:{PhotoURL:function(e){return a.Validator.value(e).required("Загрузите картинку")},"review.author":function(e){return a.Validator.value(e).required("Введите имя")},"review.occ":function(e){return a.Validator.value(e).required("Введите титул")},"review.text":function(e){return a.Validator.value(e).required("Введите отзыв")}},components:{errorTooltip:function(){return r.e(0).then(r.bind(null,444))}},data:function(){return{PhotoURL:"",review:{photo:"",author:"",occ:"",text:""}}},computed:u({},Object(i.d)("reviews",{reviewAdd:function(e){return e.reviewAdd},readyReview:function(e){return e.readyReview}}),{formTitle:function(){switch(this.reviewAdd.editMode){case!0:return"Редактирование отзыва";case!1:return"Новый отзыв"}},PhotoPath:function(){return"".concat(_,"/").concat(this.review.photo)}}),methods:u({},Object(i.c)("reviews",["CLOSE_FORM"]),{},Object(i.b)("reviews",["addReview","editReview"]),{addAndRender:function(e){var t=this,r=e.target.files[0];this.review.photo=r;var o=new FileReader;try{o.readAsDataURL(r),o.onload=function(){t.PhotoURL=o.result}}catch(e){console.error(e.message)}},createreviewAddData:function(){var e=new FormData;return e.append("author",this.review.author),e.append("occ",this.review.occ),e.append("text",this.review.text),e.append("photo",this.review.photo),e},addNewReview:(d=s(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$validate();case 2:if(e.t0=e.sent,!1!==e.t0){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,t=this.createreviewAddData(),e.next=9,this.addReview(t);case 9:this.CLOSE_FORM(),e.next=15;break;case 12:e.prev=12,e.t1=e.catch(5),console.error(e.t1.message);case 15:case"end":return e.stop()}}),e,this,[[5,12]])}))),function(){return d.apply(this,arguments)}),setReadyReview:function(){this.review=u({},this.readyReview),this.PhotoURL=this.PhotoPath},saveReadyReview:(v=s(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$validate();case 2:if(e.t0=e.sent,!1!==e.t0){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,t={id:this.review.id,data:this.createreviewAddData()},e.next=9,this.editReview(t);case 9:this.CLOSE_FORM(),e.next=15;break;case 12:e.prev=12,e.t1=e.catch(5),console.error(e.t1.message);case 15:case"end":return e.stop()}}),e,this,[[5,12]])}))),function(){return v.apply(this,arguments)})}),created:function(){this.reviewAdd.editMode&&this.setReadyReview()}},p=(r(416),r(96));r.d(t,"BASE_URL",(function(){return _}));var w=Object(p.a)(f,o,[],!1,null,"46b6a48f",null);w.options.__file="src/admin/components/reviews-add.vue";t.default=w.exports}}]);