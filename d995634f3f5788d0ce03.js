(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{354:function(t,r){},390:function(t,r,o){},414:function(t,r,o){"use strict";var e=o(390);o.n(e).a},438:function(t,r,o){"use strict";o.r(r);var e=function(){var t=this,r=t.$createElement,o=t._self._c||r;return o("div",{staticClass:"form-block"},[o("h2",{staticClass:"form-block__title"},[t._v("Редактирование работы")]),o("form",{staticClass:"form work-form form-block__content form-block__content__work"},[o("div",{staticClass:"form__pic form__pic__work"},[o("label",{staticClass:"form__upload-pic"},[o("div",{staticClass:"form__upload-pic-container",class:{filled:this.PhotoURL.length,error:t.validation.firstError("PhotoURL")},style:{backgroundImage:"url("+this.PhotoURL+")"}},[o("input",{staticClass:"form__upload-pic-input",attrs:{type:"file"},on:{change:t.addAndRender}}),o("div",{staticClass:"form__upload-pic-error"},[o("error-tooltip",{attrs:{errorText:t.validation.firstError("PhotoURL")}})],1),t._m(0)])])]),o("div",{staticClass:"form__info form__info__work"},[o("div",{staticClass:"form__row"},[o("div",{staticClass:"form__column"},[o("label",{staticClass:"form__info-block",class:{error:t.validation.firstError("work.title")},attrs:{for:"title"}},[o("span",{staticClass:"form__label"},[t._v("Название")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.work.title,expression:"work.title"}],staticClass:"form__input form__input__title",attrs:{id:"title",type:"text",name:"title",placeholder:"Введите название работы"},domProps:{value:t.work.title},on:{input:function(r){r.target.composing||t.$set(t.work,"title",r.target.value)}}}),o("div",{staticClass:"form__info-block-error"},[o("error-tooltip",{attrs:{errorText:t.validation.firstError("work.title")}})],1)])])]),o("div",{staticClass:"form__row"},[o("div",{staticClass:"form__column"},[o("label",{staticClass:"form__info-block",class:{error:t.validation.firstError("work.link")},attrs:{for:"link"}},[o("span",{staticClass:"form__label"},[t._v("Ссылка")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.work.link,expression:"work.link"}],staticClass:"form__input form__input__link",attrs:{id:"link",type:"text",name:"link",placeholder:"Вставьте ссылку"},domProps:{value:t.work.link},on:{input:function(r){r.target.composing||t.$set(t.work,"link",r.target.value)}}}),o("div",{staticClass:"form__info-block-error"},[o("error-tooltip",{attrs:{errorText:t.validation.firstError("work.link")}})],1)])])]),o("div",{staticClass:"form__row form__row__textarea"},[o("div",{staticClass:"form__column"},[o("label",{staticClass:"form__info-block form__info-block__textarea",class:{error:t.validation.firstError("work.description")},attrs:{for:"description"}},[o("span",{staticClass:"form__label"},[t._v("Описание")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.work.description,expression:"work.description"}],staticClass:"form__textarea",attrs:{id:"description",name:"description",rows:"4",placeholder:"Введите описание работы"},domProps:{value:t.work.description},on:{input:function(r){r.target.composing||t.$set(t.work,"description",r.target.value)}}}),o("div",{staticClass:"form__info-block-error"},[o("error-tooltip",{attrs:{errorText:t.validation.firstError("work.description")}})],1)])])]),o("div",{staticClass:"form__row form__row__tags"},[o("div",{staticClass:"form__column"},[o("label",{staticClass:"form__info-block",class:{error:t.validation.firstError("readyTagsAsString")},attrs:{for:"tags"}},[o("span",{staticClass:"form__label"},[t._v("Добавление тега")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.work.techs,expression:"work.techs"}],staticClass:"form__input form__input__tags",attrs:{id:"tags",type:"text",name:"tags",placeholder:"Добавьте теги навыков"},domProps:{value:t.work.techs},on:{change:function(r){return t.ADD_TAGS(t.work.techs)},input:function(r){r.target.composing||t.$set(t.work,"techs",r.target.value)}}}),o("div",{staticClass:"form__info-block-error"},[o("error-tooltip",{attrs:{errorText:t.validation.firstError("readyTagsAsString")}})],1)])])]),o("div",{staticClass:"form__row"},[t.workAdd.editMode?o("div",{staticClass:"form__column"},[o("form-tags")],1):t._e()]),o("div",{staticClass:"form__row form__row__buttons"},[o("div",{staticClass:"form__column"},[o("div",{staticClass:"form__buttons"},[o("button",{staticClass:"button button__cancel-edit",attrs:{type:"button"},on:{click:t.CLOSE_FORM}},[t._v("Отмена")]),t.workAdd.editMode?t._e():o("button",{staticClass:"button button__save-edit",attrs:{type:"button"},on:{click:t.addNewWork}},[t._v("Сохранить")]),t.workAdd.editMode?o("button",{staticClass:"button button__save-edit",attrs:{type:"button"},on:{click:t.saveEditedWork}},[t._v("Сохранить")]):t._e()])])])])])])};e._withStripped=!0;var i=o(139),a=o(65);function s(t,r,o,e,i,a,s){try{var n=t[a](s),c=n.value}catch(t){return void o(t)}n.done?r(c):Promise.resolve(c).then(e,i)}function n(t){return function(){var r=this,o=arguments;return new Promise((function(e,i){var a=t.apply(r,o);function n(t){s(a,e,i,n,c,"next",t)}function c(t){s(a,e,i,n,c,"throw",t)}n(void 0)}))}}function c(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);r&&(e=e.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,e)}return o}function l(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?c(o,!0).forEach((function(r){d(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):c(o).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function d(t,r,o){return r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}var u,_,f="https://webdev-api.loftschool.com",p={mixins:[o(65).mixin],validators:{PhotoURL:function(t){return a.Validator.value(t).required("Добавьте картинку")},"work.title":function(t){return a.Validator.value(t).required("Добавьте название")},"work.link":function(t){return a.Validator.value(t).required("Добавьте ссылку")},"work.description":function(t){return a.Validator.value(t).required("Добавьте описание")},readyTagsAsString:function(t){return a.Validator.value(t).required("Работа должна содержать как минимум один тег (например, HTML)")}},components:{formTags:function(){return o.e(24).then(o.bind(null,443))},errorTooltip:function(){return o.e(0).then(o.bind(null,444))}},data:function(){return{PhotoURL:"",work:{title:"",techs:"",photo:"",link:"",description:""}}},computed:l({},Object(i.d)("works",{workAdd:function(t){return t.workAdd},readyWork:function(t){return t.readyWork},readyTags:function(t){return t.readyTags}}),{PhotoPath:function(){return"".concat(f,"/").concat(this.work.photo)},readyTagsAsString:function(){return this.readyTags.join(",")}}),methods:l({},Object(i.b)("works",["addWork","editWork"]),{},Object(i.c)("works",["CLOSE_FORM","ADD_TAGS"]),{addAndRender:function(t){var r=this,o=t.target.files[0];this.work.photo=o;var e=new FileReader;try{e.readAsDataURL(o),e.onload=function(){r.PhotoURL=e.result}}catch(t){console.error(t.message)}},addNewWork:(_=n(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,r=this.createWorkFormData(),t.next=9,this.addWork(r);case 9:this.CLOSE_FORM(),t.next=15;break;case 12:t.prev=12,t.t1=t.catch(5),console.error(t.t1.message);case 15:case"end":return t.stop()}}),t,this,[[5,12]])}))),function(){return _.apply(this,arguments)}),createWorkFormData:function(){var t=new FormData;return t.append("title",this.work.title),this.workAdd.editMode?t.append("techs",this.readyTagsAsString):t.append("techs",this.work.techs),t.append("photo",this.work.photo),t.append("link",this.work.link),t.append("description",this.work.description),t},setEditedWork:function(){this.work=l({},this.readyWork),this.PhotoURL=this.PhotoPath},saveEditedWork:(u=n(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,r={id:this.work.id,data:this.createWorkFormData()},t.next=9,this.editWork(r);case 9:this.CLOSE_FORM(),t.next=15;break;case 12:t.prev=12,t.t1=t.catch(5),console.error(t.t1.message);case 15:case"end":return t.stop()}}),t,this,[[5,12]])}))),function(){return u.apply(this,arguments)})}),created:function(){this.workAdd.editMode&&(this.setEditedWork(),this.work.techs="")}},m=(o(414),o(96));o.d(r,"BASE_URL",(function(){return f}));var k=Object(m.a)(p,e,[function(){var t=this.$createElement,r=this._self._c||t;return r("div",{staticClass:"form__upload-pic-content"},[r("span",{staticClass:"form__upload-pic-description"},[this._v("Перетащите или загрузите для загрузки изображения")]),r("div",{staticClass:"button button__upload-work-pic"},[this._v("Загрузить")])])}],!1,null,"5f3700bf",null);k.options.__file="src/admin/components/works-form.vue";r.default=k.exports}}]);